---
title: "Wiener Proceses and Ito's Lemma"
categories:
  - Post Formats
tags:
  - Theory
use_math: true
---

금융공학 학회에서 내준 과제를 풀다가 새로운 사실을 알게 되었다. 주가의 움직임은 물리학 이론인 브라운 운동과 확률적 과정으로 표현할 수 있다는 것이다. 이번 포스트에서는 위너 과정과 이토의 보조정리가 나오게 된 역사적 배경과 이론 소개하고자 한다.   

참조 : [John C Hull]Options, Futures, and other derivatives 9th
{: .notice--warning}

## 역사적 흐름   

로버트 브라운의 관찰할 것을 바탕으로 아인슈타인은 분자 및 원자의 실재를 수학적으로 증명하는데에 성공하였고, 입자들의 불규칙한 움직임은 브라운 운동이라고 불리고, 아인슈타인의 개념(균적으로는 모든 방향에서 가해지는 분자의 압력은 동일하지만, 특정 순간 한쪽 방향에 더 많은 분자들이 충돌하는 불균형이 발생할 때 입자는 튕겨나간다)은 랜덤워크라고 불린다. 이후 바실리에는 <투기이론> 에서 금융시장의 가격변동을 브라운운동으로 모형화하였다. 하지만, 주가의 변화가 완전히 무작위적으로 움직이면 0이하의 값을 가질 수도 있다는 모순을 가지고 있었다. 미국의 경제학자 폴 새뮤얼슨은 이러한 모순을 제거하기 위해, 주가가 무작위적인 양만큼 움직이는 것이 아닌 무작위적인 비율만큼 움직이는 것으로 바꾸어 재정의하였고 이는 주가의 기대 수익을 제외하면 주가에 로그 함수를 취한 것이 랜덤워크로 표시된다는 말과 같다. 이후 아인슈타인의 브라운 운동 모형을 완전히 수학적인 확률과정으로 변형시킨 위너의 확률적 과정이 등장한다. 위너 과정은 정규분포 N(0,t)를 따르는 확률적 과정인데 이는 특정 시점에 관계없이 두 시점을 비교했을 때 그 시차가 클수록 불확실성이 커지는 것을 의미한다. 브라운운동과 위너 과정은, 사실 이 둘은 엄밀히 말해 차이점을 가지고 있으나, 위너 과정이 마팅게일 조건을 만족하고 브라운 운동이 정규분포를 따른다는 조건을 만족한다면 두 확률과정은 동일한 것이라고 여겨질 수 있다. 이와 비슷한 시기에 일본의 이토 키요시는 미적분학에서의 연쇄법칙을 확률과정으로 가져오는 이토의 보조정리를 세웠는데, 이 정리가 기초자산과 파생상품 간의 관계를 설명해주었다. 즉, 연쇄법칙의 함수 F와 G가 기초자산과 파생상품에 대응되는 관계라는 것을 알 수 있게 되었다.

## 이론 정리
### Wiener Processes and Ito's Lemma    

시간에 따라 불확실한 방향으로 변하는 값을 가지는 변수는 확률적 과정(Stochastic process)를 따른다. 확률적 과정은 이산적인 시간과 연속적인 시간으로 구분된다. 이산 확률적 과정은 변수의 값이 특정한 고정된 시간에 따라 변한다. 반면에 연속 확률적 과정은 끊김없이 연속적으로 변한다. 앞으로 다룰 이론들의 배경은 Continuous-variable과 Continuous-time process를 전제로 한다. 실제 주가는 discrete하게 표현되지만, 사실 돈과 시간은 Continuous-variable 이기 때문이다. 이런 절차를 배우는 것은 옵션가격과 더 복잡한 파생상품에 대한 이해의 첫 단계이기 때문에 매우 중요하다.

#### Markov property   

마코브 과정은 확률적 과정(stochastic process)의 일종으로서 시점 t에서의 관찰값 {xt}가 주어지면 그 이전의 관찰값은 필요가 없다. 시점 t에서의 미래 예측은 {xt}에만 의존하고 그 이전의 관찰값에는 의존하지 않기 때문이다. 금융공학 관점에서 보면 미래의 주가는 현재의 주가에만 영향을 받고 그 이전의 과거 주가에 의해 영향을 받지 않는다. 주가는 마코브 과정을 따른다고 가정한다. 가격이 100달러인 주식이 있다고 가정하자. 만약 주가가 마코브 과정을 따른다면, 향후 주가의 예측은 일주일전의 주가나 한달, 혹은 일년전의 주가의 영향을 받지 않는다. 오직 100달러라는 현재 주가의 영향만을 받을 뿐이다. 마코브 과정에서 미래 특정 시점의 주가는 확률 분포를 따르고, 과거 주가의 추이와는 독립적인 성격을 가진다. 또한, 마코브 성질은 **약형 효율적 시장 가설** 의 개념과 일치한다.   

>**약형 효율적 시장 가설** : 주가에 과거의 모든 시장정보가 반영되어 있으므로, 시장 거래자료만으로는 장기적으로 시장 수익률을 넘을 수 없다.   
**준강형 효율적 시장 가설** : 가격에 과거의 시장정보뿐 아니라 공개적으로 이용 가능한 모든 정보가 반영되어 있어, 시장 거래 자료 외에 해당 기업의 전망과 관련된 공개 정보까지 이용해도 장기적으로 시장 수익률을 넘을 수 없다.   
**강형 효율적 시장 가설** : 주가는 해당 기업의 전망과 관련된 모든 정보를 반영하므로, 비공개 정보까지 알고 내부자거래를 해도 장기적으로 시장 수익률을 넘을 수 없다.      

만약 약형 효율적 시장가설이 참이 아니라면, 기술적 분석가들은 과거 주가의 흐름을 분석하여 평균 이상의 수익률을 낼 수 있을 것이다. 그들이 실제로 이렇게 할 수 있다는 증거는 거의 없다.
{: .notice--warning}

#### Continuous-time Stochastic Processes   

마코브 확률적 과정을 따르는 변수가 있다고 하자. 현재 가격은 10달러이고, 1년동안의 주가의 움직은 N(0,1)인 평균이 0이고 분산이 1인 정규분포를 따른다고 하자. 2년동안의 주가 변화는 어떠한 분포를 따를까?   
이는 두 정규분포의 합으로 나타낼 수 있을 것이다. 마코브 확률과정에서는 각 변수는 독립적이기 때문이다. 따라서, 2년동안의 변화는 평균은 0 이고 분산은 2인 정규분포를 따른다. 표준편차는 $ \sqrt{2} $.   
6개월동안의 변화를 고려해보자. 1년동안의 변화는 N(0,1)을 따르는 것은 사실 두 기간 (6개월+6개월)인 것이므로, 6개뤌의 변화는 N(0,0.5)를 따른다.   
마찬가지로 3개월은 N(0,0.25)를 따른다. 일반화 시키면, T기간동안의 변화는 N(0,T)를 따르고, 매우 짧은 기간(Δt) 동안의 변화는 N(0,Δt)을 따른다.   
마코브 확률과정에 따르면, 분산은 연속적인 시간에서 합산으로 구할 수있는데, 표준편차는 그렇지 않다. 그 결과는 불확실성을 시간의 제곱근에 비례하는 것으로 언급하는 이유를 설명한다   

#### Wiener Process       

지금까지 고려한 변수가 따른 확률과정을 위너과정이라고 부른다. 주로, 물리학에서 분자의 움직임을 설명하는 브라운 운동과 관련하여 사용되었다.    
변수 z는 다음과 같은 두 가지 성질을 가질 때 위너과정을 따른다.

>Property 1. The change Δz during a small period of time Δt is   

 $$ \Delta z = \epsilon\sqrt{\Delta t} $$    

>Property 2. The values of Δz for any two different short intervals of time, Δt, are independent.

**Example**      
위너 과정을 따르는 변수 z의 초기값은 25이다. (시간단위는 1년) 1년 동안의 움직임은 평균이 25, 분산이 1인 정규분포를 따른다. 5년 동안의 변화는 평균 25, 표준편차 루트 5 즉 2.236인 정규분포를 따른다.
{: .notice-primary}

미적분학은 보통 작은 변화량에서 0 극한하게 갈 때를 다룬다. 그래서, dx = a dt 은  Δt->0으로 갈 때 x의 변화량을 의미한다.    
Δx = a Δt   
확률미적분학에서 동일하게 쓰인다. 위너 과정을 dz라 할 때, dz 는 Δt->0으로 갈 때 Δz를 의미한다.
![image](https://user-images.githubusercontent.com/56333934/89040328-90fc1100-d37e-11ea-984b-9034f5f7ef5c.png)

위의 그림을 보면 Δt가 작아질수록 더 들쭉날쭉한걸 볼 수 있는데, Δt가 작을 수록 $ \sqrt{Δt} $의 값은 더 커지고 이는 표준편차가 커지는 것을 의미한다. 이와 관련된 위너 과정의 두 가지 성질은 다음과 같다.
>Property 1. The expected length of the path followed by z in any time interval is infinite.   
Property 2. The expected number of times z equals any particular value in any time interval is infinite.

#### Generalized Wiener Process

확률적 과정에서 단위 시간(Unit time)에 따른 평균의 변화율은 드리프트비율 이라고 하고, 단위 시간에 따른 분산의 변화율은 분산비라고 한다. 위너과정에서 dz는 드리프트비율이 0이고 분산비가 1.0이다. 드리프트비율이 0이라는 것은 미래의 특정 시간에 z의 기댓값이 현재 값과 같다는 것을 의미한다. 분산비가 1.0 이라는 것은 T구간의 z변화량은 T임을 의미한다. 따라서, 일반 위너 과정은 변수 x를
$$ dx = a dt+ b dz (a,b는 상수) $$   
로 표현할 수 있다. 우변의 dx = a dt를 t에 대해 적분하면 x = x<sub>0</sub> + at로 표현할 수 있고, x_0는 0시점의 x의 값이다.
b dz 는 x의 경로에 변동성을 추가해주는 것이다. 변동성의 양은 b에 위너과정을 곱한 것이기 때문에 $ b\epsilon\sqrt{Δt} $ 로 나타낼 수 있다.

$$ Δx = a Δt + b\epsilon\sqrt{Δt} $$

특정 구간 T에 대해
>mean of change in x = aT      
standard deviation of x = b $ \sqrt{T} $      
variance of change in x = $ b^2T $

요약하면, Generalized Wiener process는 드리프트비율이 a이고 분산비가 $ b^2 $ 인 식으로 나타낼 수 있다.
{: .notice--primary}

![image](https://user-images.githubusercontent.com/56333934/89042247-9c9d0700-d381-11ea-847d-7fe6b98425fc.png)

#### Ito's Processes   

이토 과정은 확률적 과정의 연장선이라고 볼 수 있다. 파라미터 값이었던 a, b가 기초 변수인 x 와 시간 t에 대한 함수로 표현되는 일반 위너 과정이다.

$$ dx = a(x,t)dt + b(x,t)dz $$

이토 과정의 드리프트비율과 분산비는 시간의 변화에 따라 영향을 받는다. t 부터 t+Δt 동안의 x의 변화량은 다음과 같다.

$$ Δx = a(x,t)Δt + b(x,t)\epsilon\sqrt{Δt} $$

### The Process For A Stock Price   

지금까지 배운 확률적 과정을 무배당주의 가격을 추정하는데에 사용해보고자 한다. 섣불리 주가가 위너과정을 따른다고 하기에는 무리가 있다. 위너 과정에서는 기대 드리프트비율값과 기대분산비가 상수이지만, 주가의 경우 투자자마다 요구하는 기대수익률이 주가와는 관련없이 독립적이기 때문에 이러한 모델은 적절하지 않다. 특히 기대 드리프트비율값을 상수로 하는 것은 적절치 않아서, 기대수익률로 바꿔줘야 한다. 만약 S가 시점 t에서의 주가라면, 기대드리프트비율값은 $ \mu\S $ 가 된다. $ \mu $는 짧은 시간 구간 Δt에서 주가 S의 증가율을 나타낸다.
<br>
실제에서는 투자자의 주가에 따른 기대수익률이 불확실하기 때문에 단기간 Δt 동안의 표준편차가 주가에 비례해 다음과 같은 모델이 나온다

$$ dS = \mu Sdt + \sigma Sdz $$

$$ dS/S = \mu dt + \sigma dz $$

이 공식은 주가의 특징을 설명하는데에 가장 널리 쓰이고, 변수 $ \mu $ 는 주식의 기대수익률을 의미한다. 또한 $ \sigma $ 는 주가의 변동성을 의미한다. 위험중립세계에서는 $ \mu $ 는 무위험이자율 r이 된다.

#### Discrete-Time Model   

앞서 다룬 주가 모델을 기하 브라운 운동이라고 한다. 이 모델의 이산시간(discrete-time) 버전으로 나타내면 다음과 같이 된다.

$$ ΔS/S = \mu Δt + \sigma\epsilon\sqrt{Δt} $$

$$ Δt/S \sim  N(\mu Δt, \sigma^2 Δt) $$

**Example**
변동성 30%, 기대수익률 15%인 연속복리 무배당주를 고려해보자.

$$ dS/S = 0.15dt + 0.30dz $$

만약 1주동안의 주가 변동을 본다면, Δt = 0.0192 이므로

$$ ΔS/S = 0.15 * 0.0192 + 0.30 * \sqrt{0.0192}\epsilon $$

$$ ΔS = 0.00288S + 0.0416 S\epsilon $$

#### Monte Carlo Simulation   

확률적 과정에서 몬테 카를로 시뮬레이션은 랜덤한 결과를 추출해내는 방법이다. 이는 앞서 다룬 주가 모델이 실제 환경에서 어떠한 형태를 보이는지 알기 위해 사용한다.  
엑셀 정규분포 함수 =NORMSINV(RAND()) 를 이용하여 만들어낸 향후 10주간의 데이터는(초기값 100 달러) 다음과 같이 나온다.
![image](https://user-images.githubusercontent.com/56333934/89121263-5cac6000-d4f8-11ea-818b-30b6ec8c00a7.png)   
**Note that, because the process we are simulating in Markov, the samples for $ \epsilon $ should be independent of each other.**

#### The Parameters   

주가 추정을 위한 과정에서 필요한 파라미터 값은 두 가지였다. $ \mu $ 와 $ \sigma $. 파라미터 $ \mu $는 단기간동안 투자자의 기대수익률이고 대부분의 투자자들은 더 높은 위험을 감수하기 위해 더 높은 기대수익률을 요구한다. 따라서 $ \mu $ 는 리스크의 영향을 받고, 또한 이자율에도 영향을 받는다. 이자율이 더 높을수록 기대수익률은 높아진다.

다행히도, 파생상품의 가치는 이러한 $ \mu $에 영향을 받지 않기 때문에 우리는 $ \mu $에 대해 고려하지 않아도 된다. 하지만, 주가의 변동성을 나타내는 파라미터 $ \sigma $ 는 파생상품의 가치를 결정하는데 매우 중요한 역할을 한다.

#### Ito's Lemma

옵션의 가격은 기초자산의 가격과 시간에 대한 함수로 나타낸다. 다음의 변수 x가 이토 과정을 따른다고 하자

$$ dx = a(x,t)dt + b(x,t)dz $$

변수 x의 드리프트비율 a과 분산비 $ b^2 $ 이다. 이토의 보조정리는 x와 t에 대한 함수 G는 다음을 따른다.

$$ dG = \left ( \frac{\partial G}{\partial x} a + \frac{\partial G}{\partial t}+ \frac{\partial ^2 G}{2 \partial x^2} b^2 \right )dt + \frac{\partial G}{\partial x}bdz $$

S와 t의 함수 G로 나타내면

$$ dG = \left ( \frac{\partial G}{\partial x} \mu S + \frac{\partial G}{\partial t}+ \frac{\partial ^2 G}{2 \partial x^2} \sigma ^2 S^2 \right )dt + \frac{\partial G}{\partial x}\sigma S dz $$
